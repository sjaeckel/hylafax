.\"	$Header: /usr/people/sam/fax/./man/RCS/sendfax.1,v 1.38 1995/04/08 21:36:33 sam Rel $
.\"
.\"  HylaFAX Facsimile Software
.\"
.\" Copyright (c) 1990-1995 Sam Leffler
.\" Copyright (c) 1991-1995 Silicon Graphics, Inc.
.\" HylaFAX is a trademark of Silicon Graphics
.\" 
.\" Permission to use, copy, modify, distribute, and sell this software and 
.\" its documentation for any purpose is hereby granted without fee, provided
.\" that (i) the above copyright notices and this permission notice appear in
.\" all copies of the software and related documentation, and (ii) the names of
.\" Sam Leffler and Silicon Graphics may not be used in any advertising or
.\" publicity relating to the software without the specific, prior written
.\" permission of Sam Leffler and Silicon Graphics.
.\" 
.\" THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND, 
.\" EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY 
.\" WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  
.\" 
.\" IN NO EVENT SHALL SAM LEFFLER OR SILICON GRAPHICS BE LIABLE FOR
.\" ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND,
.\" OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
.\" WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF 
.\" LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE 
.\" OF THIS SOFTWARE.
.\"
.if n .po 0
.ds Fx \fIHyla\s-1FAX\s+1\fP
.ds Ps P\s-2OST\s+2S\s-2CRIPT\s+2
.TH SENDFAX 1 "December 22, 1994"
.SH NAME
sendfax \- submit a facsimile job for transmission
.SH SYNOPSIS
.B sendfax
[
.I options
] [
.IR files ...
]
.SH DESCRIPTION
.I sendfax
submits one or more facsimile transmission requests
to a \*(Fx facsimile server.
Requests are normally processed immediately, although
they may also be queued for transmission at a later time
using a syntax identical to the
.IR at (1)
command.
For each job that is queued,
.I sendfax
prints a
.I "job identifier"
and a
.I "job group identifier"
on the standard output.
A job identifier is the token by which jobs are
identified within \*(Fx; job group identifiers are
used to reference a set of jobs that have been
submitted at the same time.
Job and job group identifiers can be supplied to the
.IR faxrm (1)
command to remove the jobs or to the
.IR faxalter (1)
command to alter job parameters.
.PP
Facsimile are made from the concatenation
of a cover page (see below)
and one or more files specified on the command line.
If no files are supplied on the command line,
.I sendfax
will read data from the standard input unless polling is requested.
.PP
.I sendfax
passes \*(Ps\(tm and
.SM TIFF
Class F documents directly through to the fax server for transmission,
and attempts to convert other file formats to either \*(Ps or
.SM TIFF.
In normal operation
.I sendfax
automatically converts
.SM ASCII\c
-text,
.IR troff (1)
output,
and
Silicon Graphics format images for transmission.
Support for other file formats can be easily added
through an extensible file typing and conversion facility; see
.IR typerules (4F).
Note that since
.SM TIFF
Class F documents are processed directly it is simple to forward
a received facsimile.
.PP
By default
.I sendfax
will generate a cover page for each facsimile that is to be transmitted.
This cover page is created by the ancillary
.IR faxcover (1)
program using information deduced by
.I sendfax
and by information supplied on the command line.
Automatic cover page generation may be suppressed with the
.B \-n
option.
.PP
In addition to sending documents,
.I sendfax
can be used to poll a remote facsimile machine to retrieve
waiting documents.
If the
.B \-p
option is specified, a polling request will be submitted
to each destination.
If a poll request is made in conjunction with the transmission
of documents, the poll request will take place after the documents
are transmitted.
Documents retrieved by polling are returned to the requestor
by electronic mail and may be viewed with a suitable viewer program.
.PP
One or more destinations may be specified on the command line
using the
.B \-d
option.
A destination is the dialing string to use to contact
the remote fax machine.
Phone numbers may include non-numeric characters for
readability\(emonly digits and ``+'' (for denoting a
country code) are significant in placing a call.
Dialing prefixes, such as ``1'' and ``011''
(for long distance calling in the United States) need
not be included if an unambigous number is specified.
Examples of unambiguous phone numbers are:
.nf
.sp .5
.RS
.ta \w'+31.77.594.313      'u
\+31.77.594.131	\fIto call the Netherlands\fP
+14159657824	\fIto call California\fP
9657824	\fIto make a local call\fP
1-215-356-1666	\fIto call Pennsylvania from within the US\fP
.RE
.sp .5
.fi
Non-numeric strings, such as ``*70'' (to defeat
call waiting), may be included in the destination phone number.
Whether or not they are stripped from the string used to
dial the destination fax machine is dependent on the dialstring
rules configured for use on the server; c.f.
.IR config (4F)
and
.IR dialrules (4F).
.PP
A destination may also be specified as
.IR user@fax-number .
In this case the
.I user
string will be passed to
.I faxcover
as the identity of the recipient.
Note that multi-word names must be enclosed in quote marks;
for example,
``Sam Leff\&ler@+1.415.555.1212''.
.SH OPTIONS
.TP 12
.BI \-a " time"
Schedule transmission at the indicated
.IR time .
Times are specified using the syntax of the
.IR at (1)
command; e.g. ``now + 30 minutes'' to schedule transmission
30 minutes in the future.
By default,
.I sendfax
schedules facsimile for ``now''.
.TP 12
.BI \-c " comments"
Pass
.I comments
to the
.IR faxcover (1)
program for inclusion in the comments field of any generated
cover page.
.TP 12
.B \-D
Enable notification by electronic mail when the
facsimile has been delivered.
By default \*(Fx will notify the submitter only if there is
a problem with a job.
.TP 12
.BI \-d " destination"
Create a job to transmit the supplied documents to
a facsimile machine at the indicated
.IR destination .
If the
.I destination
is of the form ``\fIuser\fP@\fIphone-number\fP'' then any
cover page will show \fIuser\fP as the intended receipient.
.TP 12
.BI \-f " from"
Use
.I from
as the identity of the facsimile sender.
Otherwise the sender is the user that invoked
.IR sendfax .
The sender is an account name to which the \*(Fx software
should direct notification messages.
The
.I from
identity may be a fullblown ``From:'' line, e.g.
e.g. ``Joe Blow <joe@foo.com>''
and ``joe@foo.com (Joe Blow)'' are acceptable.
If no host-part is specified in the
.I from
string the local hostname is used.
This option is useful when
.I sendfax
is invoked on behalf of another user, such as in the implementation
of an electronic mail to fax gateway.
.TP 12
.BI \-h " host\fR[\fP:modem\fR]\fP"
Force the jobs to be processed on a specific
.I host
and, optionally, using a particular
.IR modem .
The
.I host
may be either a symbolic name or a network address.
If no
.B \-h
option is supplied,
.I sendfax
uses the
.SM FAXSERVER
environment variable to identify the \*(Fx server to
which the jobs should be directed.
If no server is specified then
.I sendfax
attempts to contact a server on the local host.
If no modem is specified, the job will be submitted to any
available modem.
An alternative syntax for the server specification, \fImodem\fP@\fIhost\fP,
is also supported; e.g. ``ttym2@oxford.berkeley.edu''.
.TP 12
.BI \-i " identifier"
Use the 
.I identifier
string in any notification messages instead of the usual job
identifier number.
This option is useful for applications that cross reference
notification messages against job submissions.
.TP 12
.BI \-k " time"
Kill the job if it does not complete in the indicated
.IR time .
As for the
.B \-a
option, the
.I time
is specifed using notation compatible with
.IR at (1).
Note that the
.I time
is relative to the time of the initial transmission attempt.
The default kill time is ``now +1 day'' (one day from the time
the job is first processed).
To retry for an hour, ``now +1 hour'' could be used.
.TP 12
.B \-l
Transmit the facsimile at a vertical resolution of
98 lines/inch; otherwise known as \fIlow resolution\fP.
.TP 12
.B \-m
Transmit the facsimile at a vertical resolution of
196 lines/inch; otherwise known as \fImedium resolution\fP
or \fIfine mode\fP.
.TP 12
.B \-n
Suppress the automatic generation of a cover page for each facsimile job.
Note that polling requests do not receive a cover page unless they
are combined with the transmission of one or more files.
.TP
.B \-N
Do not notify the sender by electronic mail when the
facsimile has been delivered or requeued.
.TP 12
.B \-p
Poll each destination for any available documents.
If a poll request is made together with document transmission, the
poll operation is done after the documents are transmitted.
Documents received by polling are returned to the sender by
electronic mail.
.TP 12
.BI \-P " priority"
Assign the specified scheduling
.I priority
for each job.
A priority is an integer value in the range [0-255].
Lower values result in higher priority processing.
By default, each job is assigned 127 for an initial scheduling priority.
A job's priority is raised (numerically lowered) for each
failed attempt to transmit so that retransmit attempts
are done ahead of newly submitted jobs.
The
.I priority
may also be specified as one of the following symbolic names:
.I default
or 
.I normal
(127),
.I bulk
or
.I junk
(207),
.I high
(63).
.TP 12
.B \-R
Enable notification by electronic mail when the
facsimile has been delivered and when it is requeued for retransmission.
By default \*(Fx will notify the submitter only if there is
a problem with a job.
.TP 12
.BI \-r " regarding"
Pass 
.I regarding
to the
.IR faxcover (1)
program as the value of the ``Re:'' field of any generated cover page.
.TP 12
.BI \-s " size"
Set the page size to use for the transmitted facsimile.
Facsimile are normally imaged with a system-default page size
(usually letter-size pages, 8.5" by 11", for sites in North America).
Alternate page sizes are specified symbolically using either
the name or abbreviation of an entry in the
.IR pagesizes (4F)
database; e.g.
.I a3
(ISO A3),
.I a4
(ISO A4),
.I a5
(ISO A5),
.I a6
(ISO A6),
.I b4
(ISO B4),
.I na-let
(North American Letter),
.I us-leg
(American Legal),
.I us-led
(American Ledger),
.I us-exe
(American Executive),
.I jp-let
(Japanese Letter),
and
.I jp-leg
(Japanese Legal).
Comparisons are case-insensitive and any match of a
substring of the full page-size name is sufficient; e.g. ``legal'' would
match ``American Legal''.
.IP
Note that it may not be permissible to image into the
full page area; the guaranteed reproducible area for a page is 
typically inset.
Also, note that while arbitrary page sizes can be specified through
the page size database,
only a limited set of page dimensions are supported by the
Group 3 facsimile protocol.
Thus if an odd-size facsimile is submitted for transmission
it may not be possible to determine if it can be sent
until the fax server establishes communication
with the remote facsimile machine.
.TP 12
.BI \-t " tries"
Make no more than
.I tries
attempts to send the facsimile.
By default, \*(Fx will terminate a job if:
3 consecutive attempts to send a particular page fail, or
it appears the receiver is not a facsimile machine.
Otherwise \*(Fx places no limit on the
.I number
of attempts to send a facsimile, instead terminating a job
if it is not completed within a 
.I "kill time"
timeout interval.
Note that a try
is a call in which carrier is established and the facsimile
protocol is commenced; this is contrasted with a call
attempt that might have failed because the line was busy.
.TP 12
.BI \-x " company"
Pass
.I company
to the
.IR faxcover (1)
program as the destination company name.
.TP 12
.BI \-y " location"
Pass
.I location
to the
.IR faxcover (1)
program as the destination company's location.
.TP 12
.B \-v
Print information on the standard output
about each conversion and cover sheet
generation operation it does.
If 
.B \-v
is specified twice, the protocol between
.I sendfax
and the
.I faxd.recv
server process that does the submission work on the
remote machine is also displayed.
.SH DIAGNOSTICS
The following messages are generated because of problems
encountered on the local machine.
.PP
.B "Could not call server."
The facsimile server on the remote machine did not respond.
.PP
.B "No input data; tranmission aborted."
No data was supplied (typically on the standard input).
No facsimile will be sent.
.PP
.B "Error converting data; command was "%s."
A data conversion operation failed; the shell
command that was used is printed.
.PP
.B "Can not convert %s."
Data needed to be converted for transmission, but the
required conversion rule was not located.
This may indicate that the \*(Fx
software was incorrectly installed; or perhaps
that an
.SM NFS\c
-mounted directory is temporarily unavailable.
.PP
.B "%s: Can not determine file type."
.I sendfax
was unable to deduce the type of the file.
.PP
.B "%s: Not a regular file."
The file is something other than a regular file; for
example, a directory.
.PP
The following messages may be printed by
.IR sendfax .
These messages describe problems encountered by
the server process on the remote machine.
This list is incomplete;
other messages may be generated by the server under
unusual circumstances\(em consult
.IR faxd.recv (1M)
for the complete list.
.PP
.B "Warning, no server appears to be running."
This is an information message that indicates the
job was queued for processing, but that no facsimile
server(s) appear to be running.
.PP
.B "Write error."
.I faxd.recv
encountered an I/O error while receiving a document
to transmit.
.PP
.B "Can not get your network address."
.I faxd.recv
was unable to get the client's machine name in order
to verify the client is allowed to submit a job.
.PP
.B "The server does not have a permissions file."
The facsimile server is missing the file
.BR etc/hosts .
This file must be present and contain a list of the
hosts that are allowed to submit jobs.
.PP
.B "Service refused; you do not have permission to use the fax server from %s."
The client is not permitted to submit jobs to this server from the
specified host.
Only those hosts and users listed in the file
.B etc/hosts
on the server machine are permitted to submit jobs.
.SH FILES
.ta \w'${LIBDATA}/typerules    'u
.nf
${LIBDATA}/typerules	file type and conversion rules
${LIBDATA}/pagesizes	page size database
${LIBDATA}/dialrules	optional client dialstring rules
${BIN}/faxcover	for generating cover sheets
/usr/tmp/sndfaxXXXXXX	temporary files
.fi
.SH "SEE ALSO"
.IR at (1),
.IR hylafax (1),
.IR faxalter (1),
.IR faxcover (1),
.IR faxmail (1),
.IR faxrm (1),
.IR faxstat (1),
.IR sgi2fax (1),
.IR faxq (1M),
.IR hylafax (4F),
.IR typerules (4F)
