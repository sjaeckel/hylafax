#!@SCRIPT_SH@
#	$Header: /usr/people/sam/fax/./html/tools/RCS/cat-faq.sh.in,v 1.10 1995/04/08 21:47:57 sam Rel $
#
# Copyright (c) 1994-1995 Sam Leffler
# Copyright (c) 1994-1995 Silicon Graphics, Inc.
# 
# Permission to use, copy, modify, distribute, and sell this software and 
# its documentation for any purpose is hereby granted without fee, provided
# that (i) the above copyright notices and this permission notice appear in
# all copies of the software and related documentation, and (ii) the names of
# Sam Leffler and Silicon Graphics may not be used in any advertising or
# publicity relating to the software without the specific, prior written
# permission of Sam Leffler and Silicon Graphics.
# 
# THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND, 
# EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY 
# WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  
# 
# IN NO EVENT SHALL SAM LEFFLER OR SILICON GRAPHICS BE LIABLE FOR
# ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND,
# OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
# WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF 
# LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE 
# OF THIS SOFTWARE.
#

#
# cat-faq
#

PATH=/bin:/usr/bin
test -d /usr/sbin && PATH=$PATH:/usr/sbin		# SGI and others
test -d /usr/5bin && PATH=/usr/5bin:$PATH		# Sun and others
test -d /usr/local/bin && PATH=/usr/local/bin:$PATH	# for GNU stuff

ECHO=@ECHO@
SED=@SED@
CAT=@CAT@
UNQUOTE=@CGIDIR@/unquote

$ECHO 'Content-type: text/html'
$ECHO ''

cd $PATH_TRANSLATED || {
     $CAT<<EOF
<PRE>
Fatal Error: Unable to chdir to directory $PATH_TRANSLATED

This script encountered a problem change to the specified directory.
There is a probably a problem in the URL used to invoke this script.
</PRE>
EOF
     exit 1
}

if [ -f .pages.html ]; then
    $CAT .pages.html
else
    eval `$ECHO "$QUERY_STRING" | $UNQUOTE -qn | $SED 's/PATH=[^;]*;//g'`

    putFooter()
    {
	$CAT<<'EOF'
<ADDRESS>
<A HREF="@HTMLPATH@/sam.html">Sam Leffler</A> / <A HREF="mailto:sam@engr.sgi.com">sam@engr.sgi.com</A>
</ADDRESS>

</BODY>
</HTML>
EOF
    }

    filter()
    {
	for x do
	    QNUM=`$ECHO $x | $SED 's/Q\(.*\)\.html/\1/'`
	    $SED -e '/<HEAD>/,/<\/HEAD>/d'\
		-e "/<DT>[AQ]/s//&$QNUM/" \
		-e '/^<HR>/,/^<HR>/d'\
		-e '/<ADDRESS>/,$d'\
		$x
	done
    }

    test -f "$IF" && $SED -e '/<\/HTML>/d' -e '/<ADDRESS>/,$d' $IF
    i=1
    eval f=\"\$F${i}\"
    while [ "$f"  ];
    do
	filter $f
	i=`expr $i + 1`
	eval f=\"\$F${i}\"
    done
    putFooter
fi
exit 0
