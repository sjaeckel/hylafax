#	$Header: /usr/people/sam/fax/./RCS/distrules,v 1.234 1995/04/08 22:31:24 sam Rel $
#
# HylaFAX Facsimile Software
#
# Copyright (c) 1988-1995 Sam Leffler
# Copyright (c) 1991-1995 Silicon Graphics, Inc.
# HylaFAX is a trademark of Silicon Graphics
# 
# Permission to use, copy, modify, distribute, and sell this software and 
# its documentation for any purpose is hereby granted without fee, provided
# that (i) the above copyright notices and this permission notice appear in
# all copies of the software and related documentation, and (ii) the names of
# Sam Leffler and Silicon Graphics may not be used in any advertising or
# publicity relating to the software without the specific, prior written
# permission of Sam Leffler and Silicon Graphics.
# 
# THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND, 
# EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY 
# WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  
# 
# IN NO EVENT SHALL SAM LEFFLER OR SILICON GRAPHICS BE LIABLE FOR
# ANY SPECIAL, INCIDENTAL, INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND,
# OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
# WHETHER OR NOT ADVISED OF THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF 
# LIABILITY, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE 
# OF THIS SOFTWARE.
#

#
# HylaFAX distribution rules.
#

PORTFILES=\
    port/Makefile.in				\
    port/install.sh.in				\
    port/mkdepend.in				\
    port/cuserid.c				\
    port/flock.c				\
    port/ftruncate.c				\
    port/mkstemp.c				\
    port/random.c				\
    port/setegid.c				\
    port/seteuid.c				\
    port/setvbuf.c				\
    port/strcasecmp.c				\
    port/strtod.c				\
    port/syslog.c				\
    port/vsyslog.c				\
    port/writev.c				\
    port/irix/so_locations			\
    ${NULL}

#
# Files the comprise the html part of the distribution.
#
HTMLFILES=\
    html/Makefile.in				\
    \
    html/HOWTO.html.in				\
    html/binary.html.in				\
    html/building.html.in			\
    html/documentation.html.in			\
    html/ghostscript.html.in			\
    html/index.html.in				\
    html/install-binary.html.in			\
    html/mailing-lists.html.in			\
    html/operation.html.in			\
    html/overview.html.in			\
    html/sam.html.in				\
    html/setup.html.in				\
    html/setup-advanced.html.in			\
    html/setup-client.html.in			\
    html/source.html.in				\
    html/survey.html.in				\
    html/toc.html.in				\
    html/troubleshooting.html.in		\
    html/v2.3beta036.html.in			\
    html/Majordomo/help.html.in			\
    html/Modems/index.html.in			\
    html/Modems/att-dataport.html.in		\
    html/Modems/digicom-scout.html.in		\
    html/Modems/everex-2496d.html.in		\
    html/Modems/hayes-optima2400.html.in	\
    html/Modems/multitech-1432.html.in		\
    html/Modems/multitech-1932.html.in		\
    html/Modems/nuvo-96424pfx.html.in		\
    html/Modems/ppi-pm14400fxmt.html.in		\
    html/Modems/supra-v32bis.html.in		\
    html/Modems/telebit-t3000.html.in		\
    html/Modems/twincom-144df.html.in		\
    html/Modems/ucom-traveller96.html.in	\
    html/Modems/usr-courier.html.in		\
    html/Modems/usr-sportster.html.in		\
    html/Modems/zyxel-1496.html.in		\
    html/Modems/Telebit/faxcmds.html.in		\
    html/Modems/ZyXEL/autodetect.html.in	\
    html/Modems/ZyXEL/codes.html.in		\
    html/Modems/ZyXEL/commands.html.in		\
    html/Modems/ZyXEL/compression.html.in	\
    html/Modems/ZyXEL/examples.html.in		\
    html/Modems/ZyXEL/voice.html.in		\
    \
    html/acknowledge.html			\
    html/class1.html				\
    html/class2.0.html				\
    html/class2.html				\
    html/contrib.html				\
    html/copyright.html				\
    html/faxgateway.html			\
    html/hylafax.html				\
    html/install-source.html			\
    html/modems.html				\
    html/namechange.html			\
    html/survey-help.html			\
    html/survey-query.html			\
    html/version.html				\
    html/ftpmail-help.html			\
    html/v2.3beta036special.html		\
    html/v3.0beta096.html			\
    html/v3.0beta100.html			\
    html/v3.0beta108.html			\
    html/v3.0beta110.html			\
    html/v3.0beta111.html			\
    html/v3.0beta112.html			\
    html/v3.0beta113.html			\
    html/Modems/Supra/class2.html		\
    html/Modems/Supra/class1.html		\
    html/Modems/Hayes/hayes.html		\
    \
    html/tools/Makefile.in			\
    html/tools/man2html.c			\
    html/tools/unquote.c			\
    html/tools/manpage.sh.in			\
    html/tools/faxsurvey.sh.in			\
    html/tools/majordomo.sh.in			\
    html/tools/cat-pages.sh.in			\
    html/tools/cat-faq.sh.in			\
    html/tools/faq-feedback.sh.in		\
    ${NULL}
#
# Files that are part of HylaFAX proper.
#
HYLAFAXFILES=\
    VERSION					\
    README					\
    README.ultrix				\
    TODO					\
    COPYRIGHT					\
    configure					\
    config.guess				\
    config.h.in					\
    config.sub					\
    config.site					\
    defs.in					\
    Makefile.in					\
    rules.in					\
    distrules					\
    dist/hylafax.spec				\
    dist/newalpha				\
    dist/newversion				\
    config/Makefile.in				\
	config/att-dataport			\
	config/att-dataport-2			\
	config/att-dataport-2.0			\
	config/cirrus				\
	config/class1				\
	config/class2				\
	config/class2.0				\
	config/dsi-scout+			\
	config/e-tech				\
	config/everex-2496d			\
	config/exar				\
	config/gvc-288				\
	config/gvc-288-2			\
	config/intel-400e			\
	config/mt-1432				\
	config/moto-288				\
	config/nuvo-voyager			\
	config/ppi-pm14400fxmt			\
	config/ppi-pm14400fxsa			\
	config/rc144ac				\
	config/rc144ac-1			\
	config/rc288dpi				\
	config/rc288dpi-1			\
	config/rc32acl				\
	config/rc32acl-1			\
	config/skel				\
	config/telebit-qblazer			\
	config/telebit-t3000			\
	config/telebit-wb			\
	config/tricom2842			\
	config/uds-fastalk			\
	config/usr-2.0				\
	config/usr-rts				\
	config/usr-xon				\
	config/zyxel-1496e			\
	config/zyxel-1496e-1			\
	config/zyxel-1496e-2.0			\
    etc/Makefile.in				\
	etc/copy.h				\
	etc/copy.m				\
	etc/copy.ps				\
	etc/dialrules				\
	etc/dialrules.sf-ba			\
	etc/dialrules.europe			\
	etc/hylafax.in				\
	etc/faxaddmodem.sh.in			\
	etc/probemodem.sh.in			\
	etc/lockname.c				\
	etc/lutRS18.pcf				\
	etc/ondelay.c				\
    util/Makefile.in				\
    util/Makefile.dso				\
	util/Array.c++				\
	util/AtSyntax.c++			\
	util/BoolArray.c++			\
	util/DialRules.c++			\
	util/Dictionary.c++			\
	util/Dispatcher.c++			\
	util/Fatal.c++				\
	util/FaxClient.c++			\
	util/FaxDB.c++				\
	util/FmtTime.c++			\
	util/IOHandler.c++			\
	util/Obj.c++				\
	util/PageSize.c++			\
	util/RegEx.c++				\
	util/RegExArray.c++			\
	util/SendFaxClient.c++			\
	util/StackBuffer.c++			\
	util/Str.c++				\
	util/StrArray.c++			\
	util/StrDict.c++			\
	util/Sys.c++				\
	util/TimeOfDay.c++			\
	util/Timeout.c++			\
	util/TypeRules.c++			\
	util/Array.h				\
	util/BoolArray.h			\
	util/DSmacros.h				\
	util/DialRules.h			\
	util/Dictionary.h			\
	util/Dispatcher.h			\
	util/FaxClient.h			\
	util/FaxDB.h				\
	util/IOHandler.h			\
	util/Obj.h				\
	util/PageSize.h				\
	util/Ptr.h				\
	util/RegEx.h				\
	util/RegExArray.h			\
	util/SendFaxClient.h			\
	util/StackBuffer.h			\
	util/Str.h				\
	util/StrArray.h				\
	util/StrDict.h				\
	util/Sys.h				\
	util/TimeOfDay.h			\
	util/Timeout.h				\
	util/Types.h				\
	util/TypeRules.h			\
	util/cvtfacility.c			\
	util/faxinfo.c++			\
	util/faxmsg.c				\
	util/fxassert.c				\
	util/pagesizes.in			\
	util/notify.awk				\
	util/faxcron.sh.in			\
	util/faxrcvd.sh.in			\
	util/mkcover.sh.in			\
	util/notify.sh.in			\
	util/pollrcvd.sh.in			\
	util/ps2fax.dps.sh.in			\
	util/ps2fax.gs.sh.in			\
	util/recvstats.sh.in			\
	util/transcript.sh.in			\
	util/xferstats.sh.in			\
	util/typerules				\
	util/fax.chestrc			\
	util/fax.ftr				\
	util/cover.templ			\
	util/dpsprinter.ps			\
	util/faxdb				\
	util/checkat.c++			\
	util/dialtest.c++			\
	util/textfmt.c++			\
	util/typetest.c++			\
	\
	util/regex.h				\
	util/regex/README			\
	util/regex/COPYRIGHT			\
	util/regex/WHATSNEW			\
	util/regex/cclass.h			\
	util/regex/cname.h			\
	util/regex/engine.c			\
	util/regex/re_format.7			\
	util/regex/regcomp.c			\
	util/regex/regerror.c			\
	util/regex/regex.3			\
	util/regex/regex2.h			\
	util/regex/regexec.c			\
	util/regex/regfree.c			\
	util/regex/utils.h			\
    fax2ps/Makefile.in				\
    faxalter/Makefile.in			\
	faxalter/faxalter.c++			\
    faxcover/Makefile.in			\
	faxcover/faxcover.c++			\
	faxcover/faxcover.ps			\
    faxd/Makefile.in				\
    faxd/Makefile.dso				\
	faxd/Class0.h				\
	faxd/Class1.h				\
	faxd/Class2.h				\
	faxd/Class20.h				\
	faxd/Class2Ersatz.h			\
	faxd/Class2Params.h			\
	faxd/ClassModem.h			\
	faxd/DestControl.h			\
	faxd/DestInfo.h				\
	faxd/FaxAcctInfo.h			\
	faxd/FaxConfig.h			\
	faxd/FaxFont.h				\
	faxd/FaxMachineInfo.h			\
	faxd/FaxMachineLog.h			\
	faxd/FaxModem.h				\
	faxd/FaxRecvInfo.h			\
	faxd/FaxRequest.h			\
	faxd/FaxSendStatus.h			\
	faxd/FaxServer.h			\
	faxd/FaxTrace.h				\
	faxd/G3Base.h				\
	faxd/G3Decoder.h			\
	faxd/G3Encoder.h			\
	faxd/Getty.h				\
	faxd/GettyBSD.h				\
	faxd/GettySysV.h			\
	faxd/HDLCFrame.h			\
	faxd/Job.h				\
	faxd/Modem.h				\
	faxd/ModemConfig.h			\
	faxd/ModemServer.h			\
	faxd/PCFFont.h				\
	faxd/QLink.h				\
	faxd/ServerConfig.h			\
	faxd/UUCPLock.h				\
	faxd/class2.h				\
	faxd/faxApp.h				\
	faxd/faxGettyApp.h			\
	faxd/faxQueueApp.h			\
	faxd/faxRequest.h			\
	faxd/faxSendApp.h			\
	faxd/pageSendApp.h			\
	faxd/ixo.h				\
	faxd/t.30.h				\
	faxd/Class0.c++				\
	faxd/Class1.c++				\
	faxd/Class1Poll.c++			\
	faxd/Class1Recv.c++			\
	faxd/Class1Send.c++			\
	faxd/Class2.c++				\
	faxd/Class20.c++			\
	faxd/Class2Ersatz.c++			\
	faxd/Class2Params.c++			\
	faxd/Class2Poll.c++			\
	faxd/Class2Recv.c++			\
	faxd/Class2Send.c++			\
	faxd/ClassModem.c++			\
	faxd/CopyQuality.c++			\
	faxd/DestControl.c++			\
	faxd/DestInfo.c++			\
	faxd/FaxAcctInfo.c++			\
	faxd/FaxConfig.c++			\
	faxd/FaxFont.c++			\
	faxd/FaxMachineInfo.c++			\
	faxd/FaxMachineLog.c++			\
	faxd/FaxModem.c++			\
	faxd/FaxPoll.c++			\
	faxd/FaxRecv.c++			\
	faxd/FaxRecvInfo.c++			\
	faxd/FaxRequest.c++			\
	faxd/FaxSend.c++			\
	faxd/FaxServer.c++			\
	faxd/G3Base.c++				\
	faxd/G3Decoder.c++			\
	faxd/G3Encoder.c++			\
	faxd/Getty.c++				\
	faxd/GettyBSD.c++			\
	faxd/GettySysV.c++			\
	faxd/HDLCFrame.c++			\
	faxd/Job.c++				\
	faxd/Modem.c++				\
	faxd/ModemConfig.c++			\
	faxd/ModemServer.c++			\
	faxd/PCFFont.c++			\
	faxd/QLink.c++				\
	faxd/ServerConfig.c++			\
	faxd/TagLine.c++			\
	faxd/UUCPLock.c++			\
	faxd/faxApp.c++				\
	faxd/faxGettyApp.c++			\
	faxd/faxQueueApp.c++			\
	faxd/faxRequest.c++			\
	faxd/faxSendApp.c++			\
	faxd/pageSendApp.c++			\
	faxd/tagtest.c++			\
	faxd/tsitest.c++			\
	faxd/tif_compress.c			\
    faxmail/Makefile.in				\
	faxmail/README				\
	faxmail/faxmail.c++			\
	faxmail/haeberli.ps			\
	faxmail/calligraphy.ps			\
	faxmail/mailfax.sh-sendmail		\
	faxmail/mailfax.sh-smail		\
    faxrm/Makefile.in				\
	faxrm/faxrm.c++				\
    faxstat/Makefile.in				\
	faxstat/FaxStatClient.h			\
	faxstat/RecvStatus.h			\
	faxstat/SendStatus.h			\
	faxstat/ServerStatus.h			\
	faxstat/FaxStatClient.c++		\
	faxstat/RecvStatus.c++			\
	faxstat/SendStatus.c++			\
	faxstat/ServerStatus.c++		\
	faxstat/faxstat.c++			\
    libtiff/Makefile.in				\
    libtiff/Makefile.dso			\
    man/Makefile.in				\
	man/cid.4f				\
	man/config.4f				\
	man/destctrls.4f			\
	man/dialrules.4f			\
	man/dialtest.1m				\
	man/fax2ps.1				\
	man/faxabort.1m				\
	man/faxaddmodem.1m			\
	man/faxalter.1				\
	man/faxanswer.1m			\
	man/faxcover.1				\
	man/faxcron.1m				\
	man/faxq.1m				\
	man/faxgetty.1m				\
	man/faxsend.1m				\
	man/faxd.recv.1m			\
	man/faxmail.1				\
	man/faxquit.1m				\
	man/faxrcvd.1m				\
	man/faxrm.1				\
	man/faxstat.1				\
	man/hosts.4f				\
	man/hylafax.1				\
	man/hylafax.4f				\
	man/info.4f				\
	man/log.4f				\
	man/mkcover.1m				\
	man/notify.1m				\
	man/pagesend.1m				\
	man/pagesizes.4f			\
	man/pollrcvd.1m				\
	man/ps2fax.1m				\
	man/recvq.4f				\
	man/recvstats.1m			\
	man/sendfax.1				\
	man/sendpage.1				\
	man/sendq.4f				\
	man/sgi2fax.1				\
	man/status.4f				\
	man/tagtest.1m				\
	man/textfmt.1				\
	man/transcript.1m			\
	man/tsi.4f				\
	man/tsitest.1m				\
	man/typerules.4f			\
	man/xferlog.4f				\
	man/xferstats.1m			\
    recvfax/Makefile.in				\
	recvfax/alter.c				\
	recvfax/auth.c				\
	recvfax/defs.h				\
	recvfax/jobs.c				\
	recvfax/main.c				\
	recvfax/remove.c			\
	recvfax/status.c			\
	recvfax/submit.c			\
	recvfax/tif_compress.c			\
	recvfax/regex.c++			\
    sendfax/Makefile.in				\
	sendfax/sendfax.c++			\
    sendpage/Makefile.in			\
	sendpage/sendpage.c++			\
    sgi2fax/Makefile.in				\
	sgi2fax/hipass.c			\
	sgi2fax/hipass.h			\
	sgi2fax/imgtofax.c			\
	sgi2fax/izoom.c				\
	sgi2fax/izoom.h				\
	sgi2fax/lum.h				\
	sgi2fax/lut.c				\
	sgi2fax/lut.h				\
	sgi2fax/rand.c				\
	sgi2fax/row.c				\
    ${PORTFILES}				\
    ${HTMLFILES}				\
    ${NULL}
#
# Files imported from libtiff.
#
TIFFFILES=\
    libtiff/t4.h				\
    libtiff/tif_fax3.h				\
    libtiff/tiff.h				\
    libtiff/tiffcomp.h				\
    libtiff/tiffconf.h				\
    libtiff/tiffio.h				\
    libtiff/tiffiop.h				\
    libtiff/mkg3states.c			\
    libtiff/tif_aux.c				\
    libtiff/tif_ccittrle.c			\
    libtiff/tif_close.c				\
    libtiff/tif_compress.c			\
    libtiff/tif_dir.c				\
    libtiff/tif_dirinfo.c			\
    libtiff/tif_dirread.c			\
    libtiff/tif_dirwrite.c			\
    libtiff/tif_dumpmode.c			\
    libtiff/tif_error.c				\
    libtiff/tif_fax3.c				\
    libtiff/tif_fax4.c				\
    libtiff/tif_flush.c				\
    libtiff/tif_getimage.c			\
    libtiff/tif_jpeg.c				\
    libtiff/tif_lzw.c				\
    libtiff/tif_next.c				\
    libtiff/tif_open.c				\
    libtiff/tif_packbits.c			\
    libtiff/tif_print.c				\
    libtiff/tif_read.c				\
    libtiff/tif_strip.c				\
    libtiff/tif_swab.c				\
    libtiff/tif_thunder.c			\
    libtiff/tif_tile.c				\
    libtiff/tif_unix.c				\
    libtiff/tif_version.c			\
    libtiff/tif_warning.c			\
    libtiff/tif_write.c				\
    ${NULL}
#
# Files imported from tiff/contrib/fax2ps.
#
FAX2PSFILES=\
    fax2ps/README				\
    fax2ps/defs.h				\
    fax2ps/fax2ps.c				\
    fax2ps/faxdecode.c				\
    fax2ps/savefont.ps				\
    ${NULL}
#
# HTML-related files that aren't under RCS.
#
HTMLDIST=\
    html/Majordomo/flexfax.info			\
    html/Majordomo/flexfax-announce.info	\
    html/FAQ/*.html.in				\
    html/icons/next.gif				\
    html/icons/button.excl.gif			\
    html/icons/faq.new.gif			\
    html/icons/faq.old.gif			\
    html/icons/faq.updated.gif			\
    html/icons/back.gif				\
    html/icons/smiley.gif			\
    html/icons/ball_blue_icon.gif		\
    html/icons/warning_icon.gif			\
    html/icons/at_work_icon.gif			\
    html/icons/info_icon.gif			\
    html/icons/new.gif				\
    html/icons/faq-feedback.gif			\
    html/icons/improved.gif			\
    ${NULL}
#
# Adobe Font Metric information files.
#
AFMFILES=\
    afm/Makefile.in				\
    afm/AvantGarde-Book.afm			\
    afm/AvantGarde-BookOblique.afm		\
    afm/AvantGarde-Demi.afm			\
    afm/AvantGarde-DemiOblique.afm		\
    afm/Bookman-Demi.afm			\
    afm/Bookman-DemiItalic.afm			\
    afm/Bookman-Light.afm			\
    afm/Bookman-LightItalic.afm			\
    afm/Courier-Bold.afm			\
    afm/Courier-BoldOblique.afm			\
    afm/Courier-Oblique.afm			\
    afm/Courier.afm				\
    afm/Helvetica-Bold.afm			\
    afm/Helvetica-BoldOblique.afm		\
    afm/Helvetica-Narrow-Bold.afm		\
    afm/Helvetica-Narrow-BoldOblique.afm	\
    afm/Helvetica-Narrow-Oblique.afm		\
    afm/Helvetica-Narrow.afm			\
    afm/Helvetica-Oblique.afm			\
    afm/Helvetica.afm				\
    afm/NewCenturySchlbk-Bold.afm		\
    afm/NewCenturySchlbk-BoldItalic.afm		\
    afm/NewCenturySchlbk-Italic.afm		\
    afm/NewCenturySchlbk-Roman.afm		\
    afm/Palatino-Bold.afm			\
    afm/Palatino-BoldItalic.afm			\
    afm/Palatino-Italic.afm			\
    afm/Palatino-Oblique.afm			\
    afm/Palatino-Roman.afm			\
    afm/Symbol.afm				\
    afm/Times-Bold.afm				\
    afm/Times-BoldItalic.afm			\
    afm/Times-Italic.afm			\
    afm/Times-Oblique.afm			\
    afm/Times-Roman.afm				\
    afm/ZapfChancery-MediumItalic.afm		\
    afm/ZapfDingbats.afm			\
    ${NULL}
#
# Files that comprise the HylaFAX source distribution.
#
DISTFILES=\
    ${HYLAFAXFILES} dist/hylafax.alpha		\
    ${TIFFFILES}				\
    ${FAX2PSFILES}				\
    ${HTMLDIST}					\
    ${AFMFILES}					\
    ${NULL}

#
# These rules are used to create the source distribution images
#
COMPRESS= gzip
ZIPSUF	= gz
CONFIG	= -with-CC=ncc \
	  -with-CXX=NCC \
	  -with-HTML \
	  -with-AFM \
	  -with-DPS \
	  -with-LIBMALLOC=no \
	  -with-SCRIPT_SH=/bin/sh

rcsclean:
	rcsclean ${HYLAFAXFILES} && co ${HYLAFAXFILES}

alpha:
	(cd ${SRCDIR}/dist; sh newversion)
	-${MAKE} clobber
	${MAKE} alpha.stamp
	${SRCDIR}/configure ${CONFIG}
	${MAKE} product
	${MAKE} alpha.tar

# stamp relevant files according to current alpha
alpha.stamp:
	VERSION=`awk '{print "Alpha" $$3}' ${SRCDIR}/dist/hylafax.alpha`;\
	NOW=`date`;							\
	for i in ${HYLAFAXFILES}; do					\
	    REV=`rlog -h -d"$$NOW" ${SRCDIR}/$$i|fgrep 'head:'|awk '{print $$2}'`;\
	    rcs "-N$$VERSION:$$REV" "-sExp:$$REV" ${SRCDIR}/$$i && co -sExp ${SRCDIR}/$$i;	\
	done

purge-old-alphas:
	VERSIONS=`awk '{for (i=1; i<=$$3; i++) printf " -nAlpha%03d",i}'\
	    ${SRCDIR}/dist/hylafax.alpha`;				\
	for i in ${HYLAFAXFILES}; do					\
	    echo rcs $$VERSIONS ${SRCDIR}/$$i;				\
	    rcs $$VERSIONS ${SRCDIR}/$$i && co ${SRCDIR}/$$i;		\
	done

alphadiff:
	-@for i in ${HYLAFAXFILES}; do					\
	    rcsdiff -r${ALPHA} ${SRCDIR}/$$i;				\
	done

# create alpha distribution archive
alpha.tar:
	VERSION="v`cat ${SRCDIR}/VERSION``awk '{print $$3}' ${SRCDIR}/dist/hylafax.alpha`";	\
	rm -f hylafax-$$VERSION $$VERSION $$VERSION-tar;		\
	ln -s ${SRCDIR} hylafax-$$VERSION;				\
	(for i in ${HYLAFAXFILES} dist/hylafax.alpha; do		\
	   echo $$i;							\
	done) | sed "s;.*;hylafax-$$VERSION/&;" >$$VERSION;		\
	tar cvf $$VERSION-tar `cat $$VERSION`;				\
	(for i in ${TIFFFILES} ${FAX2PSFILES} ${HTMLDIST} ${AFMFILES}; do\
	   echo $$i;							\
	done) | sed "s;.*;hylafax-$$VERSION/&;" >$$VERSION;		\
	tar rvf $$VERSION-tar `cat $$VERSION`;				\
	rm -f hylafax-$$VERSION-tar.${ZIPSUF};				\
	cat $$VERSION-tar | ${COMPRESS} >hylafax-$$VERSION-tar.${ZIPSUF};\
	rm -f hylafax-$$VERSION $$VERSION $$VERSION-tar;

release:
	(cd ${SRCDIR}/dist; sh newversion)
	-${MAKE} clobber
	${MAKE} release.stamp
	${SRCDIR}/configure ${CONFIG}
	${MAKE} product
	${MAKE} release.tar

release.stamp:
	VERSION="Release`sed 's/\./_/g' ${SRCDIR}/VERSION`";		\
	NOW=`date`;							\
	for i in ${HYLAFAXFILES}; do					\
	    REV=`rlog -h -d"$$NOW" ${SRCDIR}/$$i|fgrep 'head:'|awk '{print $$2}'`;\
	    rcs "-N$$VERSION:$$REV" "-sRel:$$REV" ${SRCDIR}/$$i && co -sRel ${SRCDIR}/$$i;	\
	done

# create release distribution archive
release.tar:
	VERSION=v`cat ${SRCDIR}/VERSION`;				\
	rm -f hylafax-$$VERSION $$VERSION $$VERSION-tar;		\
	ln -s ${SRCDIR} hylafax-$$VERSION;				\
	(for i in ${HYLAFAXFILES} dist/hylafax.alpha; do		\
	   echo $$i;							\
	done) | sed "s;.*;hylafax-$$VERSION/&;" >$$VERSION;		\
	tar cvf $$VERSION-tar `cat $$VERSION`;				\
	(for i in ${TIFFFILES} ${FAX2PSFILES} ${HTMLDIST} ${AFMFILES}; do\
	   echo $$i;							\
	done) | sed "s;.*;hylafax-$$VERSION/&;" >$$VERSION;		\
	tar rvf $$VERSION-tar `cat $$VERSION`;				\
	rm -f hylafax-$$VERSION-tar.${ZIPSUF};				\
	cat $$VERSION-tar | ${COMPRESS} >hylafax-$$VERSION-tar.${ZIPSUF};\
	rm -f hylafax-$$VERSION $$VERSION $$VERSION-tar;
